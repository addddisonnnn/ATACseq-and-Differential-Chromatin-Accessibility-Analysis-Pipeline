params {
    // Sample information
    samplesheet = "$projectDir/atac_samples.csv"
    
    // Reference genome - local paths
    genome_fasta = "$projectDir/reference/genome.fa"
    genome_index = "$projectDir/reference/bowtie2_index/GRCm38"
    genome_gtf = "$projectDir/reference/genes.gtf"
    chrom_sizes = "$projectDir/reference/genome.chrom.sizes"
    blacklist = "$projectDir/reference/mm10-blacklist.v2.bed"
    
    // Output directory
    outdir = "$projectDir/results/"
    
    // Analysis parameters
    macs2_gsize = "mm"
    qvalue_cutoff = 0.01
}

process {
    scratch = false
    tmpDir = "/projectnb/bf528/students/addisony/tmp"
}

workDir = "/projectnb/bf528/students/addisony/work"

profiles {
    conda {
        conda.enabled = true
    }
    
    singularity {
        singularity.enabled = true
        singularity.autoMounts = true
    }
    
    cluster {
        process {
            executor = 'sge'
            clusterOptions = '-P bf528'
            penv = 'omp'

            withLabel: process_single {
                cpus = 1
            }
            withLabel: process_low {
                cpus = 4
            }
            withLabel: process_medium {
                cpus = 8
            }
            withLabel: process_high {
                cpus = 20
            }

            withName: 'HOMER_CALLPEAK' {
                cpus = 8
                memory = '32.GB'  // Increase from 16GB to 32GB
                time = '12.h'
                errorStrategy = 'retry'
                maxRetries = 2
                maxErrors = 10
            }
        }
    }
    
    local {
        process.executor = 'local'
    }
}

executor {
    $sge {
        queueSize = 8
    }
    $local {
        cpus = 1
    }
}

resume = true